# Wazuh SIEM Threat Detection Project

## Project Overview

This project involved the design, deployment, and validation of a comprehensive Security Information and Event Management (SIEM) lab environment to simulate, detect, and analyze security events across endpoints. The lab integrates open-source technologies including Wazuh SIEM, Suricata Network IDS, and attack simulation frameworks Metasploit and MITRE Caldera.
The objective was to build end-to-end security monitoring capabilities that closely mirror production Security Operations Center (SOC) environments and demonstrate personal hands-on experience in log collection, event correlation, network threat detection, and adversary emulation using MITRE ATT&CK techniques.

## Technologies Used

- **Wazuh 4.13**: Central SIEM platform combining security monitoring, endpoint detection, and response capabilities.
- **Suricata 6.0**: Network intrusion detection system integrated with Wazuh for real-time alerting on network-based threats.
- **Operating Systems**: Windows 11 and Ubuntu 24.04 LTS for agent deployment and endpoint monitoring.
- **Metasploit Framework**: Penetration testing tool for simulated attack generation.
- **MITRE Caldera**: Adversary emulation platform to replicate attacker behaviors based on MITRE ATT&CK framework.
- **Virtualization**: VMWare Workstation to host lab virtual machines.

## Architecture and Design

The infrastructure comprises multiple virtual machines within an isolated homelab network facilitating realistic multi-OS monitoring:

- **Wazuh All-in-One Server**: Runs Wazuh Manager, Wazuh Indexer, and Dashboard services on Ubuntu Server.
- **Windows Agent VM**: Hosts the Wazuh Agent and Sysmon for event logging.
- **Linux Agent VM (Ubuntu)**: Runs Wazuh Agent and Suricata IDS for host and network event monitoring.
- **Attacker VM (Kali Linux)**: Used for launching penetration tests and adversary emulation using Metasploit and MITRE Caldera.

The network is configured with host adapters to allow communication between VMs while isolating the lab environment.

<img width="500" height="501" alt="image" src="https://github.com/user-attachments/assets/158ff6c9-357d-40cd-b556-28245d373e52" />


## Implementation Steps

### SIEM Deployment

- Installed Ubuntu Server and deployed the Wazuh all-in-one installation script.
- Verified component status: Wazuh Manager, Indexer, and Dashboard.
- Deployed Wazuh Agents on Windows and Linux VMs, with custom configurations to collect Windows Event Logs, Sysmon logs, and Linux system logs.

<img width="750" height="750" alt="dashboard" src="https://github.com/user-attachments/assets/c88db0fd-750c-41e3-8aae-3856c4d2a7ae" />



### Network IDS Integration

- Installed and configured Suricata to monitor network traffic on the Linux endpoint.
- Configured Suricata to output JSON-format logs (`eve.json`) consumed by Wazuh.
- Validated integration by generating test traffic and confirming Suricata alerts within Wazuh.


### Log Collection and Analysis

- Configured collection of enriched telemetry such as Sysmon logs on Windows for process creation, network connections, and command execution.
- Collected Linux system logs including SSH authentication and syslog events.
- Established log parsing and alerting rules within Wazuh to handle diverse data sources.
<img width="750" height="750" alt="Screenshot_20251023_134149" src="https://github.com/user-attachments/assets/d84c0c7e-7a2e-48de-ad1d-213c6a0d26f8" />
<img width="750" height="750" alt="wazuh-alerts" src="https://github.com/user-attachments/assets/34534283-dab7-4949-9101-ad685200099e" />


### Attack Simulation and Detection

- Conducted reconnaissance, brute force, and exploit simulations using Metasploit originating from the attacker VM, targeting the Windows agent. (MITRE ATT&CK mapping: T1110 – Brute Force (Credential Access))
- Simulated an attacker gaining administrator permissions and downgrading the security of Windows client's SMB component. (MITRE ATT&CK mappings: T1499 – Endpoint Denial of Service (Impact) and T1021 – Remote Services (Lateral Movement / Initial Access))
- Monitored and correlated alerts generated by simulated attacks in Wazuh dashboard.
<img width="750" height="750" alt="wazuh-smb1" src="https://github.com/user-attachments/assets/0fa25b27-5e40-48ae-86a4-8ef53bfa99e2" />
<img width="750" height="750" alt="wazuh-smb1-2" src="https://github.com/user-attachments/assets/ed46d07f-4cf7-43fd-8417-e09566d141c1" />


## Results and Findings

The deployed SIEM lab achieved a 100% detection rate across multiple simulated attack scenarios, demonstrating the effectiveness of combined host and network-based monitoring. Key observed detections included:

- Network reconnaissance and port scanning by Suricata.
- Authentication failures and brute force attempts via Windows Event Logs.
- Process creation and command execution from Sysmon events.

This environment provided invaluable insight into incident detection workflows, alert tuning, and the importance of comprehensive log collection.

## Lessons Learned

- Proper configuration of log sources and agents is essential to ensure complete visibility.
- Network IDS enhances detection capabilities for lateral movement and external threats.
- Performance tuning and resource management are critical in consolidated lab environments.


## Future Work

- Incorporate automated response mechanisms and case management tools such as TheHive.
- Integrate additional threat intelligence feeds to improve alert contextualization.
- Expand monitoring coverage to cloud workloads and containerized environments.
- Develop more granular detection rules tailored to specific use cases.


## Conclusion

This project successfully demonstrated real-world SIEM deployment skills using open-source security technologies and attack simulation frameworks. It provides a solid foundation for security operations roles by aligning practical experience with industry best practices and frameworks.
